From 88d614b6b739119fe0da666050bfac70c432ac33 Mon Sep 17 00:00:00 2001
From: Icenowy Zheng <uwu@icenowy.me>
Date: Sat, 16 Mar 2024 16:30:39 +0800
Subject: [PATCH 3/4] return covering crtc even rotated

for present get_crtc

Signed-off-by: Icenowy Zheng <uwu@icenowy.me>
---
 src/common_drm.c | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

diff --git a/src/common_drm.c b/src/common_drm.c
index 18ab316..ca0d54a 100644
--- a/src/common_drm.c
+++ b/src/common_drm.c
@@ -1067,13 +1067,7 @@ xf86CrtcPtr common_drm_drawable_covering_crtc(DrawablePtr pDraw)
 
 	box_init(&box, pDraw->x, pDraw->y, pDraw->width, pDraw->height);
 
-	crtc = common_drm_covering_crtc(pScrn, &box, NULL, &crtcbox);
-
-	/* Make sure the CRTC is valid and this is the real front buffer */
-	if (crtc && crtc->rotatedData)
-		crtc = NULL;
-
-	return crtc;
+	return common_drm_covering_crtc(pScrn, &box, NULL, &crtcbox);
 }
 
 static inline uint32_t req_crtc(xf86CrtcPtr crtc)
-- 
2.44.0

